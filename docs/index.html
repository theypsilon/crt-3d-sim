<html>
<head>
  <title>CRT 3D Sim</title>
  <link rel="stylesheet" href="style.css">
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
</head>
<body>
  <img id="loading" src="assets/Loading_icon.gif">
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="bootstrap-theme.min.css">
  <div id="ui" class="container display-none">
    <a href="https://github.com/theypsilon"><img style="position: absolute; top: 0; left: 0; border: 0; width: 8%;" src="assets/forkme.png" alt="Fork me on GitHub"></a>
    <div class="page-header">
      <h1>CRT 3D Sim</h1>
    </div>
    <p>This tool is a proof of concept of a sandbox to create filters that mitigate the unrealistic experience of watching content designed for old CRTs in modern LCD screens.</p>
    <p>Don't get why this is a thing? <a href="#explanation">Read some explanation below.</a></p>
    <p>MOBILE DEVICES WON'T WORK! You need a PC with NVIDIA or ATI graphics card with updated drivers and a modern browser (but not Edge) in order to run this without problems.</p>
    <form id="form" name="form">
      <div class="render-tests row">
        <div class="render-panel-dad col-sm-6">
          <h3 class="page-header">Render test animation</h3>
          <div class="well render-panel">
            <div class="gif"><img src="assets/wwix.gif"></div><br/>
            <input id="start-animation" class="start" type="button" value="Launch">
          </div>
        </div>
        <div class="render-panel-dad col-sm-6">
          <h3 class="page-header">Render image from your disk</h3>
          <div class="well render-panel">
            <input type="file" id="file" class="display-none" accept="image/*">
            <div id="drop-zone">drop an image file here or click to upload it</div>
            <input id="start-custom" class="start" type="button" value="Launch" title="You need to have an image first" disabled>
          </div>
        </div>
      </div>
      <div>
        <h3 class="page-header">Options</h3>
        <div class="well options">
          <div class="option-inputs">
            <label for="antialias">antialias:</label>
            <input type="checkbox" id="antialias" value="antialias">
          </div>
          <div class="option-inputs">
            <label for="powerPreference">powerPreference:</label>
            <input type="radio" id="powerPreference-1" name="powerPreference" value="default" /><div class="option-text">default</div>
            <input type="radio" id="powerPreference-2" name="powerPreference" value="high-performance" /><div class="option-text">high-performance</div>
            <input type="radio" id="powerPreference-3" name="powerPreference" value="low-power" /><div class="option-text">low-power</div>
          </div>
          <div class="option-inputs">
            <label for="scale">scale transform:</label>
            <div class="scale-radio" title="None"><input type="radio" id="scale-1" name="scale" value="1" /><div class="option-text">none</div></div>
            <div class="scale-radio" title="NES, SNES"><input type="radio" id="scale-2" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">256x224 on 4:3</div></div>
            <div class="scale-radio" title="NES PPU"><input type="radio" id="scale-2" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">256x240 on 4:3</div></div>
            <div class="scale-radio" title="Mega Drive"><input type="radio" id="scale-2" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">320x224 on 4:3</div></div>
            <div class="scale-radio" title="Game Boy"><input type="radio" id="scale-3" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">160x144 on 4:3</div></div>
            <div class="scale-radio" title="Game Boy Advance"><input type="radio" id="scale-3" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">240x160 on 4:3</div></div>
            <div class="scale-radio" title="DOS"><input type="radio" id="scale-3" name="scale" value="1.1428571428571428571428571428571" /><div class="option-text">320x200 on 4:3</div></div>
            <div class="scale-radio" title="Introduce the values yourself"><input type="radio" id="scale-custom" name="scale" /><div class="option-text">custom</div></div>
          </div>
          <div id="scale-custom-inputs" class="display-none">
            <div class="option-inputs">
            <label for="scale-x">horizontal scaling:</label>
            <input type="number" id="scale-x" value="1" min="0.25" max="4">
            </div>
            <div class="option-inputs">
            <label for="scale-y">vertical scaling:</label>
            <input type="number" id="scale-y" value="1" min="0.25" max="4">
            </div>
          </div>
        </div>
      </div>
    </form>
    <div>
      <h3 class="page-header">Explanation:</h3>
      <a name="explanation"></a>
      <p>Old systems, like the NES, SNES, or Mega Drive, did usually work with resolutions such as 256x224 or 320x224 that would be deformed to fit a 4:3 screen. Graphics were designed with this aspect ratio transformation in mind. Therefore, when scaling them up by multiplying the original resolution by a given factor, those graphics are distorted if not using some sort of filtering for that matter. Stretching the images to fit a 4:3 aspect ratio within the current resolution also gives distortion as result, because of pixel interpolation, but is usually a preferred solution.</p>
      <p>Another issue is that the CRTs didn't render perfectly adyacent and squared pixels. This also alters heavily the perception of old graphics, which in today screens are looking too sharp, and in some cases just plain bad. Pre-rendered sprites are specially affected by this, but in general, charm is lost all over the board.</p>
      <p>In order to preserve the CRT-era content, lots of work have been done in filters. They work usually by blending pixels and introducing gaps and effects. And they can be quite good, but there is still a significant amount of progress to be done in order to get closer to the original look.</p>
      <p>This project tries to experiment in a 3D space where every pixel is a 3D object. This is an approach that I haven't seen so far, so I had to give it a try. Right now, pixels can be cubes and squares, but it's the goal of this tool to explore new shapes and lighting properties.</p>
      <p>With the given controls, it's easy to recreate a simple scanlines filter. But the current resolutions seem to be a limitating factor as of now. The results are noticeably better in higher resolutions, such as 4k, which is the one I use most during testing.</p>
      <p>The tool renders automatically in your current screen resolution. Computing cost is heavy, so a good GPU is needed to work with high screen resolutions and high resolution images. I recommend you to upload 256x224 pictures, which is the original use case I intended to cover. Keep in mind the scaling options you can select below, to fix tthe aspect ratio missmatches when working with retro images.</p>
    </div>
    <footer class="clear">
      <h3 class="page-header">Credits:</h3>
      <label>Concept + Implementation:</label><p>Jos√© Manuel Barroso Galindo &lt;theypsilon@gmail.com&gt;</p>
      <label>Test animation sprites:</label><p>Ryoga &lt;pig_saint@gmail.com&gt;</p>
    </footer>
  </div>
  <div id="info-panel" class="display-none">
    <div id="fps-counter-holder"><div id="fps-counter"></div><span>FPS</span></div>
    <h3>Info Panel</h3>
    <div class="info-category">
      <h5>Camera Movements</h5>
      <div id="camera-movement-indicator">
        <div class="camera-field-header"><div class="camera-coordinate">X</div><div class="camera-coordinate">Y</div><div class="camera-coordinate">Z</div></div>
        <div id="camera-pos" class="camera-field-group">
          <div class="camera-field-name">pos:</div>
          <div id="camera-pos-x" class="camera-field camera-field-left"></div>
          <div id="camera-pos-y" class="camera-field camera-field-center"></div>
          <div id="camera-pos-z" class="camera-field camera-field-right"></div>
        </div>
        <div id="camera-dir" class="camera-field-group">
          <div class="camera-field-name">dir:</div>
          <div id="camera-dir-x" class="camera-field camera-field-left camera-field-mid"></div>
          <div id="camera-dir-y" class="camera-field camera-field-center camera-field-mid"></div>
          <div id="camera-dir-z" class="camera-field camera-field-right camera-field-mid"></div>
        </div>
        <div id="camera-axis-up" class="camera-field-group">
          <div class="camera-field-name">axis:</div>
          <div id="camera-axis-up-x" class="camera-field camera-field-left"></div>
          <div id="camera-axis-up-y" class="camera-field camera-field-center"></div>
          <div id="camera-axis-up-z" class="camera-field camera-field-right"></div>
        </div>
      </div>
      <ul>
        <li><div id="feature-advance" class="feature-hotkeys">W, S</div><div class="feature-explanation">back and forth.</div></li>
        <li><div id="feature-strafe" class="feature-hotkeys">A, D</div><div class="feature-explanation">left and right.</div></li>
        <li><div id="feature-climb" class="feature-hotkeys">Q, E</div><div class="feature-explanation">up and down.</div></li>
        <li><div id="feature-turn" class="feature-hotkeys">Arrow keys</div><div class="feature-explanation">turn camera up, down, left and right.</div></li>
        <li><div id="feature-rotate" class="feature-hotkeys">+, -</div><div class="feature-explanation">rotate camera.</div></li>
        <li><div id="feature-rotate" class="feature-hotkeys">Hold left click mouse button</div><div class="feature-explanation">to control the camera with the mouse.</div></li>
      </ul>
    </div>
    <div class="info-category">
      <h5>Pixel manipulation</h5>
      <ul>
        <li><div id="feature-size-x" class="feature-hotkeys">J, K</div><div class="feature-explanation">to change pixel width.</div><div class="feature-value"><div id="pixel-scale-x" class="feature-container">0</div></div></li>
        <li><div id="feature-size-y" class="feature-hotkeys">U, I</div><div class="feature-explanation">to change pixel height.</div><div class="feature-value"><div id="pixel-scale-y" class="feature-container">0</div></div></li>
        <li><div id="feature-gap" class="feature-hotkeys">N, M</div><div class="feature-explanation">to change distance between pixels.</div><div class="feature-value"><div id="pixel-gap" class="feature-container">0</div></div></li>
        <li><div id="feature-pulsation" class="feature-hotkeys">P</div><div class="feature-explanation">to activate a wave on the screen.</div></li>
        <li><div id="feature-change-pixel-shape" class="feature-hotkeys">O</div><div class="feature-explanation">show pixels as cubes.</div></li>
      </ul>
    </div>
    <div class="info-category">
      <h5>Velocity</h5>
      <ul>
        <li><div id="feature-change-move-speed" class="feature-hotkeys">F, R</div><div class="feature-explanation">changes the camera translation speed.</div></li>
        <li><div id="feature-change-turn-speed" class="feature-hotkeys">Alt+F, Alt+R</div><div class="feature-explanation">changes the camera turn speed.</div></li>
        <li><div id="feature-change-pixel-speed" class="feature-hotkeys">Shift+F, Shift+R</div><div class="feature-explanation">changes the pixel manipulation speed.</div></li>
      </ul>
    </div>
    <div class="info-category">
      <h5>Others</h5>
      <ul>
        <li><div id="feature-quit" class="feature-hotkeys">ESC</div><div class="feature-explanation">to quit the application.</div></li>
        <li><div id="feature-info-panel" class="feature-hotkeys">SPACE</div><div class="feature-explanation">to toggle visibility of this panel.</div></li>
      </ul>
    </div>
    <div class="info-button">
      <input id="info-hide" type="button" value="Hide this panel">
    </div>
  </div>
<script type="text/javascript" src="entrypoint.js"></script></body>
</html>