!function(e){function n(n){for(var t,r,i=n[0],c=n[1],d=0,u=[];d<i.length;d++)r=i[d],o[r]&&u.push(o[r][0]),o[r]=0;for(t in c)Object.prototype.hasOwnProperty.call(c,t)&&(e[t]=c[t]);for(a&&a(n);u.length;)u.shift()()}var t={},o={0:0};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r.oe=function(e){throw console.error(e),e},r.w={};var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var d=0;d<i.length;d++)n(i[d]);var a=c;r(r.s=2)}([function(e,n,t){"use strict";t.r(n),t.d(n,"main",function(){return d}),t.d(n,"__widl_f_new_with_event_init_dict_CustomEvent",function(){return g}),t.d(n,"__widl_f_set_onkeydown_Document",function(){return y}),t.d(n,"__widl_f_set_onkeyup_Document",function(){return x}),t.d(n,"__widl_f_set_onmousedown_Document",function(){return v}),t.d(n,"__widl_f_set_onmousemove_Document",function(){return R}),t.d(n,"__widl_f_set_onmouseup_Document",function(){return G}),t.d(n,"__widl_f_set_onwheel_Document",function(){return I}),t.d(n,"__widl_instanceof_Event",function(){return P}),t.d(n,"__widl_f_new_Event",function(){return M}),t.d(n,"__widl_instanceof_EventTarget",function(){return D}),t.d(n,"__widl_f_dispatch_event_EventTarget",function(){return S}),t.d(n,"__widl_instanceof_KeyboardEvent",function(){return B}),t.d(n,"__widl_f_key_KeyboardEvent",function(){return j}),t.d(n,"__widl_instanceof_MouseEvent",function(){return H}),t.d(n,"__widl_f_buttons_MouseEvent",function(){return q}),t.d(n,"__widl_f_movement_x_MouseEvent",function(){return z}),t.d(n,"__widl_f_movement_y_MouseEvent",function(){return K}),t.d(n,"__widl_f_now_Performance",function(){return X}),t.d(n,"__widl_instanceof_WebGL2RenderingContext",function(){return J}),t.d(n,"__widl_f_bind_vertex_array_WebGL2RenderingContext",function(){return N}),t.d(n,"__widl_f_buffer_data_with_opt_array_buffer_WebGL2RenderingContext",function(){return Z}),t.d(n,"__widl_f_create_vertex_array_WebGL2RenderingContext",function(){return te}),t.d(n,"__widl_f_draw_arrays_instanced_WebGL2RenderingContext",function(){return re}),t.d(n,"__widl_f_uniform2fv_with_f32_array_WebGL2RenderingContext",function(){return ae}),t.d(n,"__widl_f_uniform3fv_with_f32_array_WebGL2RenderingContext",function(){return se}),t.d(n,"__widl_f_uniform_matrix4fv_with_f32_array_WebGL2RenderingContext",function(){return fe}),t.d(n,"__widl_f_vertex_attrib_divisor_WebGL2RenderingContext",function(){return pe}),t.d(n,"__widl_f_attach_shader_WebGL2RenderingContext",function(){return ge}),t.d(n,"__widl_f_bind_buffer_WebGL2RenderingContext",function(){return be}),t.d(n,"__widl_f_clear_WebGL2RenderingContext",function(){return he}),t.d(n,"__widl_f_clear_color_WebGL2RenderingContext",function(){return Le}),t.d(n,"__widl_f_compile_shader_WebGL2RenderingContext",function(){return Ee}),t.d(n,"__widl_f_create_buffer_WebGL2RenderingContext",function(){return Ce}),t.d(n,"__widl_f_create_program_WebGL2RenderingContext",function(){return We}),t.d(n,"__widl_f_create_shader_WebGL2RenderingContext",function(){return Pe}),t.d(n,"__widl_f_enable_WebGL2RenderingContext",function(){return De}),t.d(n,"__widl_f_enable_vertex_attrib_array_WebGL2RenderingContext",function(){return Se}),t.d(n,"__widl_f_get_attrib_location_WebGL2RenderingContext",function(){return ke}),t.d(n,"__widl_f_get_error_WebGL2RenderingContext",function(){return Ae}),t.d(n,"__widl_f_get_program_info_log_WebGL2RenderingContext",function(){return He}),t.d(n,"__widl_f_get_program_parameter_WebGL2RenderingContext",function(){return qe}),t.d(n,"__widl_f_get_shader_info_log_WebGL2RenderingContext",function(){return ze}),t.d(n,"__widl_f_get_shader_parameter_WebGL2RenderingContext",function(){return Ke}),t.d(n,"__widl_f_get_uniform_location_WebGL2RenderingContext",function(){return Xe}),t.d(n,"__widl_f_link_program_WebGL2RenderingContext",function(){return $e}),t.d(n,"__widl_f_shader_source_WebGL2RenderingContext",function(){return Qe}),t.d(n,"__widl_f_uniform1f_WebGL2RenderingContext",function(){return en}),t.d(n,"__widl_f_use_program_WebGL2RenderingContext",function(){return tn}),t.d(n,"__widl_f_vertex_attrib_pointer_with_i32_WebGL2RenderingContext",function(){return rn}),t.d(n,"__widl_instanceof_WheelEvent",function(){return cn}),t.d(n,"__widl_f_delta_y_WheelEvent",function(){return an}),t.d(n,"__widl_instanceof_Window",function(){return un}),t.d(n,"__widl_f_request_animation_frame_Window",function(){return ln}),t.d(n,"__widl_f_document_Window",function(){return _n}),t.d(n,"__widl_f_performance_Window",function(){return wn}),t.d(n,"__widl_f_error_2_",function(){return mn}),t.d(n,"__widl_f_log_2_",function(){return yn}),t.d(n,"__wbg_new_b0f6b20c16090c90",function(){return hn}),t.d(n,"__wbg_fill_9f0d9c86387a5bbe",function(){return Ln}),t.d(n,"__wbg_buffer_1034a5b5085bbbb5",function(){return En}),t.d(n,"__wbg_newnoargs_b1f726fad978f5a3",function(){return Rn}),t.d(n,"__wbg_call_fa7f0da29d7b9250",function(){return Gn}),t.d(n,"__wbg_new_70e5fc804058d6a0",function(){return Wn}),t.d(n,"__wbg_set_3387446d3253486c",function(){return Pn}),t.d(n,"Animation_Source",function(){return Mn}),t.d(n,"__wbindgen_object_clone_ref",function(){return Dn}),t.d(n,"__wbindgen_object_drop_ref",function(){return Sn}),t.d(n,"__wbindgen_string_new",function(){return Bn}),t.d(n,"__wbindgen_number_new",function(){return kn}),t.d(n,"__wbindgen_boolean_get",function(){return Tn}),t.d(n,"__wbindgen_cb_drop",function(){return An}),t.d(n,"__wbindgen_closure_wrapper44",function(){return jn}),t.d(n,"__wbindgen_throw",function(){return Hn}),t.d(n,"__wbindgen_Math_tan",function(){return Fn});var o=t(1);const r=[{obj:void 0},{obj:null},{obj:!0},{obj:!1}];let i=r.length;function c(e){i===r.length&&r.push(r.length+1);const n=i,t=r[n];return i=t,r[n]={obj:e,cnt:1},n<<1}function d(e,n){const t=n.ptr;if(0===t)throw new Error("Attempt to use a moved value");return n.ptr=0,o.f(c(e),t)}let a=null;function u(){return null!==a&&a.buffer===o.g.buffer||(a=new Uint32Array(o.g.buffer)),a}let s=new TextDecoder("utf-8"),l=null;function f(){return null!==l&&l.buffer===o.g.buffer||(l=new Uint8Array(o.g.buffer)),l}function _(e,n){return s.decode(f().subarray(e,e+n))}const p=[];function w(e){if(1==(1&e))return p[e>>1];return r[e>>1].obj}function g(e,n,t,o){let r=_(e,n);try{return c(new CustomEvent(r,w(t)))}catch(e){const n=u();n[o/4]=1,n[o/4+1]=c(e)}}function m(e,n){for(;e;){let t=Object.getOwnPropertyDescriptor(e,n);if(t)return t;e=Object.getPrototypeOf(e)}throw new Error(`descriptor for id='${n}' not found`)}const b=m(Document.prototype,"onkeydown").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onkeydown').set does not exist")};function y(e,n){b.call(w(e),w(n))}const h=m(Document.prototype,"onkeyup").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onkeyup').set does not exist")};function x(e,n){h.call(w(e),w(n))}const L=m(Document.prototype,"onmousedown").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onmousedown').set does not exist")};function v(e,n){L.call(w(e),w(n))}const E=m(Document.prototype,"onmousemove").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onmousemove').set does not exist")};function R(e,n){E.call(w(e),w(n))}const C=m(Document.prototype,"onmouseup").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onmouseup').set does not exist")};function G(e,n){C.call(w(e),w(n))}const W=m(Document.prototype,"onwheel").set||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Document.prototype, 'onwheel').set does not exist")};function I(e,n){W.call(w(e),w(n))}function P(e){return w(e)instanceof Event?1:0}function M(e,n,t){let o=_(e,n);try{return c(new Event(o))}catch(e){const n=u();n[t/4]=1,n[t/4+1]=c(e)}}function D(e){return w(e)instanceof EventTarget?1:0}const O=EventTarget.prototype.dispatchEvent||function(){throw new Error("wasm-bindgen: EventTarget.prototype.dispatchEvent does not exist")};function S(e,n,t){try{return O.call(w(e),w(n))?1:0}catch(e){const n=u();n[t/4]=1,n[t/4+1]=c(e)}}function B(e){return w(e)instanceof KeyboardEvent?1:0}const k=m(KeyboardEvent.prototype,"key").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(KeyboardEvent.prototype, 'key').get does not exist")};let T=new TextEncoder("utf-8");function A(e){const n=T.encode(e),t=o.c(n.length);return f().set(n,t),[t,n.length]}function j(e,n){const[t,o]=A(k.call(w(n))),r=u();r[e/4]=t,r[e/4+1]=o}function H(e){return w(e)instanceof MouseEvent?1:0}const F=m(MouseEvent.prototype,"buttons").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(MouseEvent.prototype, 'buttons').get does not exist")};function q(e){return F.call(w(e))}const U=m(MouseEvent.prototype,"movementX").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(MouseEvent.prototype, 'movementX').get does not exist")};function z(e){return U.call(w(e))}const V=m(MouseEvent.prototype,"movementY").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(MouseEvent.prototype, 'movementY').get does not exist")};function K(e){return V.call(w(e))}const Y=Performance.prototype.now||function(){throw new Error("wasm-bindgen: Performance.prototype.now does not exist")};function X(e){return Y.call(w(e))}function J(e){return w(e)instanceof WebGL2RenderingContext?1:0}const $=WebGL2RenderingContext.prototype.bindVertexArray||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.bindVertexArray does not exist")};function N(e,n){$.call(w(e),w(n))}const Q=WebGL2RenderingContext.prototype.bufferData||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.bufferData does not exist")};function Z(e,n,t,o){Q.call(w(e),n,w(t),o)}const ee=WebGL2RenderingContext.prototype.createVertexArray||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.createVertexArray does not exist")};function ne(e){return void 0===e||null===e}function te(e){const n=ee.call(w(e));return ne(n)?0:c(n)}const oe=WebGL2RenderingContext.prototype.drawArraysInstanced||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.drawArraysInstanced does not exist")};function re(e,n,t,o,r){oe.call(w(e),n,t,o,r)}const ie=WebGL2RenderingContext.prototype.uniform2fv||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.uniform2fv does not exist")};let ce=null;function de(e,n){return(null!==ce&&ce.buffer===o.g.buffer||(ce=new Float32Array(o.g.buffer)),ce).subarray(e/4,e/4+n)}function ae(e,n,t,o){let r=de(t,o);ie.call(w(e),w(n),r)}const ue=WebGL2RenderingContext.prototype.uniform3fv||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.uniform3fv does not exist")};function se(e,n,t,o){let r=de(t,o);ue.call(w(e),w(n),r)}const le=WebGL2RenderingContext.prototype.uniformMatrix4fv||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.uniformMatrix4fv does not exist")};function fe(e,n,t,o,r){let i=de(o,r);le.call(w(e),w(n),0!==t,i)}const _e=WebGL2RenderingContext.prototype.vertexAttribDivisor||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.vertexAttribDivisor does not exist")};function pe(e,n,t){_e.call(w(e),n,t)}const we=WebGL2RenderingContext.prototype.attachShader||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.attachShader does not exist")};function ge(e,n,t){we.call(w(e),w(n),w(t))}const me=WebGL2RenderingContext.prototype.bindBuffer||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.bindBuffer does not exist")};function be(e,n,t){me.call(w(e),n,w(t))}const ye=WebGL2RenderingContext.prototype.clear||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.clear does not exist")};function he(e,n){ye.call(w(e),n)}const xe=WebGL2RenderingContext.prototype.clearColor||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.clearColor does not exist")};function Le(e,n,t,o,r){xe.call(w(e),n,t,o,r)}const ve=WebGL2RenderingContext.prototype.compileShader||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.compileShader does not exist")};function Ee(e,n){ve.call(w(e),w(n))}const Re=WebGL2RenderingContext.prototype.createBuffer||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.createBuffer does not exist")};function Ce(e){const n=Re.call(w(e));return ne(n)?0:c(n)}const Ge=WebGL2RenderingContext.prototype.createProgram||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.createProgram does not exist")};function We(e){const n=Ge.call(w(e));return ne(n)?0:c(n)}const Ie=WebGL2RenderingContext.prototype.createShader||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.createShader does not exist")};function Pe(e,n){const t=Ie.call(w(e),n);return ne(t)?0:c(t)}const Me=WebGL2RenderingContext.prototype.enable||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.enable does not exist")};function De(e,n){Me.call(w(e),n)}const Oe=WebGL2RenderingContext.prototype.enableVertexAttribArray||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.enableVertexAttribArray does not exist")};function Se(e,n){Oe.call(w(e),n)}const Be=WebGL2RenderingContext.prototype.getAttribLocation||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getAttribLocation does not exist")};function ke(e,n,t,o){let r=_(t,o);return Be.call(w(e),w(n),r)}const Te=WebGL2RenderingContext.prototype.getError||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getError does not exist")};function Ae(e){return Te.call(w(e))}const je=WebGL2RenderingContext.prototype.getProgramInfoLog||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getProgramInfoLog does not exist")};function He(e,n,t){const o=je.call(w(n),w(t)),[r,i]=ne(o)?[0,0]:A(o),c=u();c[e/4]=r,c[e/4+1]=i}const Fe=WebGL2RenderingContext.prototype.getProgramParameter||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getProgramParameter does not exist")};function qe(e,n,t){return c(Fe.call(w(e),w(n),t))}const Ue=WebGL2RenderingContext.prototype.getShaderInfoLog||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getShaderInfoLog does not exist")};function ze(e,n,t){const o=Ue.call(w(n),w(t)),[r,i]=ne(o)?[0,0]:A(o),c=u();c[e/4]=r,c[e/4+1]=i}const Ve=WebGL2RenderingContext.prototype.getShaderParameter||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getShaderParameter does not exist")};function Ke(e,n,t){return c(Ve.call(w(e),w(n),t))}const Ye=WebGL2RenderingContext.prototype.getUniformLocation||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.getUniformLocation does not exist")};function Xe(e,n,t,o){let r=_(t,o);const i=Ye.call(w(e),w(n),r);return ne(i)?0:c(i)}const Je=WebGL2RenderingContext.prototype.linkProgram||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.linkProgram does not exist")};function $e(e,n){Je.call(w(e),w(n))}const Ne=WebGL2RenderingContext.prototype.shaderSource||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.shaderSource does not exist")};function Qe(e,n,t,o){let r=_(t,o);Ne.call(w(e),w(n),r)}const Ze=WebGL2RenderingContext.prototype.uniform1f||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.uniform1f does not exist")};function en(e,n,t){Ze.call(w(e),w(n),t)}const nn=WebGL2RenderingContext.prototype.useProgram||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.useProgram does not exist")};function tn(e,n){nn.call(w(e),w(n))}const on=WebGL2RenderingContext.prototype.vertexAttribPointer||function(){throw new Error("wasm-bindgen: WebGL2RenderingContext.prototype.vertexAttribPointer does not exist")};function rn(e,n,t,o,r,i,c){on.call(w(e),n,t,o,0!==r,i,c)}function cn(e){return w(e)instanceof WheelEvent?1:0}const dn=m(WheelEvent.prototype,"deltaY").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(WheelEvent.prototype, 'deltaY').get does not exist")};function an(e){return dn.call(w(e))}function un(e){return w(e)instanceof Window?1:0}const sn=function(e){return this.requestAnimationFrame(e)};function ln(e,n,t){try{return sn.call(w(e),w(n))}catch(e){const n=u();n[t/4]=1,n[t/4+1]=c(e)}}const fn=function(){return this.document};function _n(e){const n=fn.call(w(e));return ne(n)?0:c(n)}const pn=function(){return this.performance};function wn(e){const n=pn.call(w(e));return ne(n)?0:c(n)}const gn=console.error;function mn(e,n){gn(w(e),w(n))}const bn=console.log;function yn(e,n){bn(w(e),w(n))}function hn(e){return c(new Float32Array(w(e)))}const xn=Float32Array.prototype.fill||function(){throw new Error("wasm-bindgen: Float32Array.prototype.fill does not exist")};function Ln(e,n,t,o){return c(xn.call(w(e),n,t,o))}const vn=m(Float32Array.prototype,"buffer").get||function(){throw new Error("wasm-bindgen: GetOwnOrInheritedPropertyDescriptor(Float32Array.prototype, 'buffer').get does not exist")};function En(e){return c(vn.call(w(e)))}function Rn(e,n){let t=_(e,n);return c(new Function(t))}const Cn=Function.prototype.call||function(){throw new Error("wasm-bindgen: Function.prototype.call does not exist")};function Gn(e,n,t){try{return c(Cn.call(w(e),w(n)))}catch(e){const n=u();n[t/4]=1,n[t/4+1]=c(e)}}function Wn(){return c(new Object)}const In=Reflect.set.bind(Reflect)||function(){throw new Error("wasm-bindgen: Reflect.set.bind(Reflect) does not exist")};function Pn(e,n,t,o){try{return In(w(e),w(n),w(t))?1:0}catch(e){const n=u();n[o/4]=1,n[o/4+1]=c(e)}}class Mn{free(){const e=this.ptr;this.ptr=0,function(e){o.a(e)}(e)}constructor(e,n,t,r,i,c,d){this.ptr=o.e(e,n,t,r,i,c,d)}add(e){return o.d(this.ptr,c(e))}}function Dn(e){if(1==(1&e))return c(w(e));return r[e>>1].cnt+=1,e}function On(e){if((e>>=1)<4)return;let n=r[e];n.cnt-=1,n.cnt>0||(r[e]=i,i=e)}function Sn(e){On(e)}function Bn(e,n){return c(_(e,n))}function kn(e){return c(e)}function Tn(e){let n=w(e);return"boolean"==typeof n?n?1:0:2}function An(e){let n=w(e).original;n.a=n.b=0,On(e)}function jn(e,n,t){let r=function(e){let n=this.a;this.a=0;try{return this.f(n,c(e))}finally{this.a=n}};r.f=o.b.get(n),r.a=e;let i=r.bind(r);return i.original=r,c(i)}function Hn(e,n){throw new Error(_(e,n))}function Fn(e){return Math.tan(e)}},function(e,n,t){"use strict";var o=t.w[e.i];e.exports=o;t(0);o.h()},function(e,n,t){const o=document.getElementById("ui"),r=document.getElementById("form"),i=document.getElementById("loading"),c=document.getElementById("file"),d=document.getElementById("start-custom"),a=document.getElementById("start-animation"),u=document.getElementById("antialias"),s=document.getElementById("scale-x"),l=document.getElementById("scale-y"),f=document.getElementById("scale-custom-inputs"),_=document.getElementById("drop-zone"),p=document.getElementById("info-hide"),w=document.getElementById("info-panel"),g=document.getElementById("fps-counter"),m=document.getElementById("camera-pos-x"),b=document.getElementById("camera-pos-y"),y=document.getElementById("camera-pos-z"),h=document.getElementById("camera-dir-x"),x=document.getElementById("camera-dir-y"),L=document.getElementById("camera-dir-z"),v=document.getElementById("camera-axis-up-x"),E=document.getElementById("camera-axis-up-y"),R=document.getElementById("camera-axis-up-z"),C=document.getElementById("pixel-scale-x"),G=document.getElementById("pixel-scale-y"),W=document.getElementById("pixel-gap");function I(){const e=localStorage.getItem("scale")||"scale-1";document.getElementById(e).checked=!0,"scale-custom"===e&&f.classList.remove("display-none"),s.value=localStorage.getItem("scale-x")||1,l.value=localStorage.getItem("scale-y")||1,u.checked="true"===localStorage.getItem("antialias"),document.getElementById(localStorage.getItem("powerPreference")||"powerPreference-1").checked=!0,document.getElementById("preview")&&d.classList.remove("display-none"),o.classList.remove("display-none"),i.classList.add("display-none"),new Promise((e,n)=>{d.onclick=(()=>{o.classList.add("display-none"),i.classList.remove("display-none"),setTimeout(()=>{const n=document.getElementById("preview"),t=document.createElement("canvas"),o=t.getContext("2d");t.width=n.width,t.height=n.height,o.drawImage(n,0,0);var r=o.getImageData(0,0,n.width,n.height);e([r])},50)}),a.onclick=(()=>{o.classList.add("display-none"),i.classList.remove("display-none"),new Promise((e,n)=>{const t=new Image;t.src="assets/wwix_spritesheet.png",t.onload=(()=>{const n=document.createElement("canvas"),o=n.getContext("2d");n.width=t.width,n.height=t.height,o.drawImage(t,0,0);const r=Math.floor(t.width/256),i=[];for(let e=0;e<45;e++){const n=e%r,t=Math.floor(e/r);i.push(o.getImageData(256*n,224*t,256,224))}e(i)}),t.onerror=(e=>n(e))}).then(e)})}).then(async e=>{console.log((new Date).toISOString(),"image readed");const n=window.devicePixelRatio,o=window.screen.width,c=window.screen.height,d=r.querySelector('input[name="scale"]:checked');let a=1,s=1;localStorage.setItem("scale",d.id),"scale-custom"==d.id?(a=document.getElementById("scale-x").value,s=document.getElementById("scale-y").value,localStorage.setItem("scale-x",a),localStorage.setItem("scale-y",s)):a=d.value;const l=document.createElement("canvas");l.id="gl-canvas",l.width=o*n,l.height=c*n,l.style.width=o,l.style.height=c,w.style.setProperty("max-height",c-50),document.body.appendChild(l);const f=r.querySelector('input[name="powerPreference"]:checked'),_={alpha:!0,antialias:u.checked,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:f.value,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1};localStorage.setItem("antialias",_.antialias?"true":"false"),localStorage.setItem("powerPreference",f.id),console.log("gl context form",_);const p=l.getContext("webgl2",_);var g=document.documentElement;if(g.requestFullscreen=g.requestFullscreen||g.webkitRequestFullScreen||g.mozRequestFullScreen||g.msRequestFullscreen,l.onmousedown=(e=>{1==e.buttons&&(l.requestPointerLock(),window.screen.width!=window.innerWidth&&window.screen.height!=window.innerHeight&&g.requestFullscreen())}),l.requestPointerLock=l.requestPointerLock||l.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,!p)throw new Error("Could not get webgl context.");const m=await Promise.resolve().then(t.bind(null,0)),b=new m.Animation_Source(e[0].width,e[0].height,o,c,1/60,+a,+s);for(let n=0;n<e.length;n++){const t=e[n];b.add(t.data.buffer)}console.log((new Date).toISOString(),"calling wasm main"),m.main(p,b),console.log((new Date).toISOString(),"wasm main done"),i.classList.add("display-none"),w.classList.remove("display-none")})}async function P(e){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.send(null),await new Promise(e=>n.onload=(()=>e()));const t=URL.createObjectURL(n.response),o=new Image;o.src=t,await new Promise(e=>o.onload=(()=>e()));const r=document.getElementById("preview");r&&r.remove(),o.id="preview",o.width>o.height?o.style.width="100px":o.style.height="100px",_.innerHTML="",_.appendChild(o),console.log((new Date).toISOString(),"image loaded"),d.disabled=!1}window.ondrop=(e=>{e.preventDefault()}),window.ondragover=(e=>{e.preventDefault(),e.dataTransfer.dropEffect="none"}),window.addEventListener("app-event.toggle_info_panel",()=>{document.getElementById("gl-canvas")&&(w.classList.contains("display-none")?w.classList.remove("display-none"):(w.classList.add("display-none"),window.dispatchEvent(new CustomEvent("app-event.top_message",{detail:"Toggle the Info Panel by pressing SPACE."}))))},!1),window.addEventListener("app-event.exit_pointer_lock",()=>{document.exitPointerLock()},!1),window.addEventListener("app-event.exiting_session",()=>{I(),document.getElementById("gl-canvas").remove(),w.classList.add("display-none")},!1),window.addEventListener("app-event.fps",e=>{g.innerHTML=Math.round(e.detail)},!1),window.addEventListener("app-event.top_message",e=>{const n=document.getElementById("top-message");n&&n.remove();const t=document.createElement("div");t.id="top-message";const o=document.createElement("span");o.innerHTML=e.detail,t.appendChild(o),document.body.appendChild(t);let r=.75;t.style.opacity=r,setTimeout(()=>{!function e(){r>=.01?(r-=.01,t.style.opacity=r,setTimeout(e,16)):t.remove()}()},1e3)},!1),window.addEventListener("app-event.camera_update",e=>{m.innerHTML=Math.round(100*e.detail[0])/100,b.innerHTML=Math.round(100*e.detail[1])/100,y.innerHTML=Math.round(100*e.detail[2])/100,h.innerHTML=Math.round(100*e.detail[3])/100,x.innerHTML=Math.round(100*e.detail[4])/100,L.innerHTML=Math.round(100*e.detail[5])/100,v.innerHTML=Math.round(100*e.detail[6])/100,E.innerHTML=Math.round(100*e.detail[7])/100,R.innerHTML=Math.round(100*e.detail[8])/100},!1),window.addEventListener("app-event.change_pixel_scale_x",e=>{C.innerHTML=Math.round(1e3*e.detail)/1e3},!1),window.addEventListener("app-event.change_pixel_scale_y",e=>{G.innerHTML=Math.round(1e3*e.detail)/1e3},!1),window.addEventListener("app-event.change_pixel_gap",e=>{W.innerHTML=Math.round(1e3*e.detail)/1e3},!1),p.onclick=(()=>{document.getElementById("gl-canvas")&&(w.classList.add("display-none"),window.dispatchEvent(new CustomEvent("app-event.top_message",{detail:"Show the Info Panel again by pressing SPACE."})))}),c.onchange=(()=>{const e=c.files[0];P((window.URL||window.webkitURL).createObjectURL(e))}),_.onclick=(()=>{document.getElementById("file").click()}),_.ondragover=(e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),_.ondrop=(e=>{e.stopPropagation(),e.preventDefault();var n=e.dataTransfer.files[0];P((window.URL||window.webkitURL).createObjectURL(n))}),document.form.scale.forEach(e=>{e.onclick=function(){"scale-custom"===this.id?f.classList.remove("display-none"):f.classList.add("display-none")}}),I()}]);